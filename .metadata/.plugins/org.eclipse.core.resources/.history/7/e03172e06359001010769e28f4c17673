<%@ page import="java.util.*, ComputerPackage.CartItem" %>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<!DOCTYPE html>
<html>
<head>
    <title>Your Shopping Cart - TechParts</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f9f9f9;
            padding: 30px;
        }
        h2 {
            text-align: center;
            margin-bottom: 25px;
            color: #2563eb;
        }
        table {
            width: 90%;
            margin: 0 auto 30px;
            border-collapse: collapse;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        th, td {
            padding: 12px 15px;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #111827;
            color: white;
        }
        img.cart-image {
            width: 80px;
            height: auto;
            border-radius: 6px;
        }
        .btn {
            padding: 7px 14px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            color: white;
            text-decoration: none;
        }
        .btn-update {
            background-color: #2563eb;
        }
        .btn-remove {
            background-color: #ef4444;
        }
        .btn-update:hover {
            background-color: #1d4ed8;
        }
        .btn-remove:hover {
            background-color: #dc2626;
        }
        .cart-actions {
            width: 90%;
            margin: 0 auto;
            text-align: right;
            margin-top: -20px;
        }
        .btn-continue, .btn-checkout {
            padding: 10px 20px;
            margin-left: 10px;
            border-radius: 6px;
            font-weight: bold;
            text-decoration: none;
            color: white;
        }
        .btn-continue {
            background-color: #6b7280;
        }
        .btn-checkout {
            background-color: #10b981;
        }
        .btn-continue:hover {
            background-color: #4b5563;
        }
        .btn-checkout:hover {
            background-color: #059669;
        }
        .empty-message {
            text-align: center;
            font-size: 20px;
            color: #666;
            margin-top: 50px;
        }
    </style>
</head>
<body>

<h2>Your Shopping Cart</h2>

<%
    List<CartItem> cart = (List<CartItem>) session.getAttribute("cart");
    if (cart == null || cart.isEmpty()) {
%>
    <p class="empty-message">Your cart is empty. <a href="Laptops.jsp" style="color:#2563eb; text-decoration: underline;">Continue shopping</a>.</p>
<%
    } else {
        double total = 0;
%>

<table>
    <tr>
        <th>Image</th>
        <th>Name</th>
        <th>Price (Rs.)</th>
        <th>Quantity</th>
        <th>Subtotal (Rs.)</th>
        <th>Actions</th>
    </tr>

    <% for (CartItem item : cart) { 
        double subtotal = item.getPrice() * item.getQuantity();
        total += subtotal;
    %>
    <tr>
        <td><img src="<%= item.getImage() %>" alt="Product Image" class="cart-image"></td>
        <td><%= item.getName() %></td>
        <td><%= String.format("%.2f", item.getPrice()) %></td>
        <td>
            <form action="UpdateCartServlet" method="post" style="display:inline-block;">
                <input type="hidden" name="id" value="<%= item.getId() %>"/>
                <input type="number" name="quantity" value="<%= item.getQuantity() %>" min="1" style="width:60px;"/>
                <button type="submit" class="btn btn-update">Update</button>
            </form>
        </td>
        <td><%= String.format("%.2f", subtotal) %></td>
        <td>
            <form action="RemoveFromCartServlet" method="post" style="display:inline-block;">
                <input type="hidden" name="id" value="<%= item.getId() %>"/>
                <button type="submit" class="btn btn-remove" onclick="return confirm('Remove this item from your cart?');">Remove</button>
            </form>
        </td>
    </tr>
    <% } %>

    <tr>
        <td colspan="4" style="text-align:right; font-weight:bold; font-size:18px;">Total:</td>
        <td colspan="2" style="font-weight:bold; font-size:18px;">Rs. <%= String.format("%.2f", total) %></td>
    </tr>
</table>

<div class="cart-actions">
    <a href="Laptops.jsp" class="btn btn-continue">← Continue Shopping</a>
    <a href="Checkout.jsp" class="btn btn-checkout">Proceed to Checkout →</a>
</div>

<% } %>

</body>
</html>
